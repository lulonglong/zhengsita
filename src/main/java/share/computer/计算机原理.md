

## 计算机三大原则

### 第一原则：计算机是执行输入、运算、输出的机器

​		首先从硬件的基础开始介绍。从硬件上来看，可以说计算机是执行输入、运算、输出三种操作的机器。计算机的硬件由大量的 IC （Integrated Circuit，集成电路）组成（如图 1.1 所示）。每块 IC 上都带有许多引脚。这些引脚有的用于输入，有的用于输出。IC 会在其内部对外部输入的信息进行运算，并把运算结果输出到外部。

​		运算这个词听起来也许有些难以理解，但实际上就是计算的意思。计算机所做的事就是“输入”数据 1 和 2，然后对它们执行加法“运算”，最后“输出”计算结果 3。

​		小型的 IC 自不必说，就连在观察银行的在线系统这类巨型系统时，或是编写复杂的程序时，也要时常把输入、运算、输出这三者想成是一套流程，这一点很重要。其实计算机就是台简单的机器，因为它只能做这三件事。 

### 第二原则:程序是指令和数据的集合

​		所谓程序，其实非常简单，只不过是指令和数据的集合。无论程序多么高深、多么复杂，其内容也都是指令和数据。所谓指令，就是控制计算机进行输入、运算、输出的命令。把向计算机发出的指令一条条列出来，就得到了程序。这里成套出现的输入、运算、输出，就是之前在硬件的基础一节中说明过的流程。向计算机发出的指令与计算机硬件上的行为一一对应是理所当然的。 



​		在程序设计中，会为一组指令赋予一个名字，可以称之为“函数”“语句”“方法”“子例程”“子程序”等。



​		程序中的数据分为两类，一类是作为指令执行对象的输入数据， 一类是从指令的执行结果得到的输出数据。在编程时程序员会为数据赋予名字，称其为“变量”。正如数学中函数的表记方法那样，在很多编程语言中都使用着类似于下面的这种语法。 

​																				y = f(x)



###  第三原则：计算机的处理方式和人的思维习惯不同

​		计算机有计算机的处理方法，这是三大原则中的最后一点。计算机本身只不过是为我们处理特定工作的机器。 对计算机来说什么都是数字 。 

 		迄今为止，使用计算机的目的就是为了提高手工作业的效率。例如，文字处理软件可以提高编写文档的效率；电子邮件可以提高传统邮件寄送的效率。总之，作为可以提高工作效率的工具，有些靠手工作业完成的业务可以直接交给计算机处理。

​		用数字表示所有信息，这就是一个很具有代表性的计算机式的处理方法，这一点也正是和人类的思维习惯最不一样的地方。例如，人们会用“蓝色”“红色”之类的词语描述有关颜色的信息。可是换作计算机的话，就不得不用数字表示颜色信息。例如，用“0,0,255”表示蓝色，用“255,0,0”表示红色，用“255,0,255”表示由蓝色和红色混合而 成的紫色。不光是颜色，计算机对文字的处理也是如此。计算机内部会先把文字转换成相应的数字再做处理，这样的数字叫作“字符编码”。 总之计算机会把什么都用数字来表示。 



## 电子计算机由简到繁的原理图



![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/src%3Dhttp___img-blog.csdnimg.cn_2021020322333032.png_x-oss-process%3Dimage_watermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzQ5OTc4MA%3D%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70%23pic_center%26refer%3Dhttp___img-blog.csdni.webp)





![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/src%3Dhttp___image.mamicode.com_info_202002_20200229102007633636.png%26refer%3Dhttp___image.mamicode.webp)







![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/src%3Dhttp___www.51wendang.com_pic_9e4b1b67f2bd47b5c9224bbd_6-810-jpg_6-1080-0-0-1080.jpg%26refer%3Dhttp___www.51wendang.webp)







## 制作一个简单的电脑



### 制作微型计算机所必需的元件

​		让我们试着做一个最简单的电脑。制作微型计算机所需的基础元件只有3个，CPU、内存和 I/O，每种元件都是作为一块独立的 IC 在市场上出售的。CPU 是计算机的大脑，负责解释、执行程序。内存负责存储程序和数据。I/O 是 Input/Output（输入／输出）的缩写，负责将计算机和外部设备（周边设备）连接在一起。

![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/Z80.jpeg)

​												Z80 单板计算机（197x年份的产品）

​		这里我们使用 Z80 CPU 作为微型计算机的 CPU、TC5517 作为内存、Z80 PIO 作为 I/O。**Z80 CPU** 是一款古老的 CPU，在 NEC 的 PC-8801、SHARP 的 MZ-80 等 8 比特计算机广泛应用的时代，曾以爆炸般的速度普及过。**TC5517** 是可以存储 2K 的 8 比特数据的内存。在计算机的世界里，K 表示1024。TC5517 的容量是 8 比特 ×2×1024 = 16384 比特， 即 2K 字节。虽然这点容量与诸位所使用的个人计算机比起来相差悬殊，但是对于用于学习的微型计算机来说是绰绰有余了。Z80 PIO 作为 I/O，经常与 Z80 CPU 一起使用。正如其名，PIOParallel I/O，并行输入／ 输出）可以在微型计算机和外部设备之间并行地（一排一排地）输入输出 8 比特的数据。在计算机爱好者们沉浸在制作微型计算机的那个年代，这些元件都是常见的 IC。

​		为了制作微型计算机，除了 CPU、内存和 I/O，还需要若干辅助元件。

​		为了驱动 CPU 运转，称为“时钟信号”的电信号必不可少。这种电信号就好像带有一个时钟，滴答滴答地每隔一定时间就变换一次电压的高低（如图 2.2 所示）。输出时钟信号的元件叫作“时钟发生器”。 时钟发生器中带有晶振，根据其自身的频率（振动的次数）产生时钟信号。时钟信号的频率可以衡量 CPU 的运转速度。这里使用的是 

2.5MHz（兆赫兹）的时钟发生器。

![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/%E6%97%B6%E9%92%9F.png)



​		用于输入程序的装置也是必不可少的。在这里我们通过拨动指拨开关来输入程序，指拨开关是一种由 8 个开关并排连在一起构成的元件（如照片 2.1(a) 所示）。输出程序执行结果的装置是 8 个 LED（发光二极管）。到此为止，主要的元件就都备齐了。 

​		剩下的就都是些细碎的元件了。表 2.1 是所需元件的一览表，里面也包含了之前介绍过的元件。请诸位粗略地浏览一遍。所需元件表中的 74367 和 7404 也是 IC，用于提高连接外部设备时的稳定性。电阻是用于阻碍电流流动、降低电压值的元件。为了省去布线的麻烦，这里也会使用将 8 个电阻集成到 1 个元件中的集成电阻（如照片2.1(b) 所示）。电阻的单位是 Ω（欧姆）。电容是存储电荷的元件，衡量存储电荷能力的单位是 F（法拉）。要让微型计算机运转起来，5V（伏特）的直流电源是必不可少的。于是还需要使用一个叫作“开关式稳压电源”的装置，将 220V 的交流电变成 5V 的直流电。



![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/%E5%85%83%E5%99%A8%E4%BB%B6%E5%88%97%E8%A1%A8.png)

![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/%E5%85%83%E5%99%A8%E4%BB%B62.png)





### 连接电源、数据和地址总线

​		下面就开始布线吧。请假想自己正在制作微型计算机，并按照如下的说明用红铅笔在电路图中描画相应的电路。 

​		首先连接电源。IC 与普通的电器一样，只有接通了电源才能工作。Z80 CPU、TC5517 和 Z80 PIO 上都分别带有 Vcc 引脚和 GND 引脚。 Vcc 和 GND 这一对儿引脚用于为 IC 供电。下面请先将 +5V 电源连接到各个 IC 的 Vcc 引脚上，然后将 0V 电源连接到各个 IC 的 GND 引脚上。接下来还需要将 +5V 和 0V 连接到时钟发生器上。接通电源后这些 IC 和时钟发生器就可以工作了。

​		微型计算机所使用的 IC 属于数字 IC。在数字 IC 中，每个引脚上的电压要么是 0V、要么是 +5V，通过这两个电压与其他的 IC 进行电信号的收发。用于给 IC 供电的 Vcc 引脚和 GND 引脚上的电压是恒定不变的 +5V 和 0V，但是其他引脚上的电压，会随着计算机的操作在+5V 和 0V 之间不断地变化。 

​		稍微说一点题外话，只要想成 0V 表示数字 0、+5V 表示数字 1， 那么数字 IC 就是在用二进制数的形式收发信息。也正因为如此，二进制数在计算机当中才如此重要。有关二进制的内容，此处不会详细介绍，但是请先记住以下知识点：通常将 1 个二进制数（也就是数字IC 上 1 个引脚所能表示的 0 或者 1）所表示的信息称作“1 比特”，将 8个二进制数（也就是 8 比特）称作“1 字节”。比特是信息的最小单位，字节是信息的基本单位。这里制作的微型计算机是一台 8 比特微型计算机，因此是以 8 比特为一个单位收发信息的。 

​		下面回到正题。计算机以 CPU 为中心运转。CPU 可以与内存或 I/O进行数据的输入输出。为了指定输入输出数据时的源头或目的地，CPU上备有“地址总线引脚”。Z80 CPU 的地址总线引脚共有 16 个，用代号A0～A15 表示，其中的 A 表示 Address（地址）。后面的数字 0～15 表示一个 16 位的二进制数中各个数字的位置，0 对应最后一位、15 对应第一位。16 个地址总线引脚所能指定的地址共有 65536 个，用二进制数表示的话就是 0000000000000000～1111111111111111。因此 Z80 CPU可以指定 65536 个数据存取单元（内存存储单元或 I/O 地址），进行信息的输入输出。

​		一旦指定了存取数据的地址，就可以使用数据总线引脚进行数据的输入输出了。Z80 CPU 的数据总线引脚共有 8 个，用代号 D0～D7表示。其中的 D 表示 Data（数据），后面的数字 0～7 与地址总线引脚代号的规则相同，也表示二进制数中各个数字的位置。Z80 CPU可以一次性地输入输出 8 比特的数据，这就意味着如果想要输入输出位数（比特数）大于 8 比特的数据，就要以 8 比特为单位切分这个数据。作为内存的 TC5517 上也有地址总线引脚（A0～A10）和数据总线引脚（D0～D7）。这些引脚需要同 Z80 CPU 上带有相同代号的引脚相连。一块 TC5517 上可以存储 2048 个 8 比特的数据（如图 2.6 所示）。可是由于用于输入程序的指拨开关是以 8 比特为一个单位指定内存地址的，所以我们只使用 TC5517 上的 A0～A7 这 8 个引脚，并把剩余的A8～A10 引脚连接到 0V 上（这些引脚上的值永远是 0）。虽然总共有2048 个存储单元，最终却只能使用其中的 256 个，稍微有些浪费。下面就请诸位用红铅笔把 Z80 CPU 和 TC5517 的 D0～D7 以及 A0～A7引脚分别连接起来。

​				![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/%E5%86%85%E5%AD%98.png)



### 连接 I/O

​		下面开始连接 I/O。只有了解了作为 I/O 的 Z80 PIO 的结构，才能理解为什么要这样布线。诸位都知道“寄存器”这个词吗？寄存器是位于 CPU 和 I/O 中的数据存储器。Z80 PIO 上共有 4 个寄存器。2 个用于设定 PIO 本身的功能，2 个用于存储与外部设备进行输入输出的数据。这 4 个寄存器分别叫作端口 A 控制、端口 A 数据、端口 B 控制和端口 B 数据。所谓端口就是 I/O 与外部设备之间输入输出数据的场所，可以把端口（Port）想象成是轮船装卸货物的港口。Z80 PIO 有 2 个端口，端口 A 和端口 B，最多可以连接 2 个用于输入输出 8 比特数据的外部设备（如图 2.7 所示）。

![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/pio.png)

​		既然已经大体上了解了 Z80 PIO 的结构，下面就开始布线吧。因为 Z80 PIO 上也有 D0～D7 的数据总线引脚，所以先把它们和 Z80CPU 中带有同样代号的引脚连接起来。这样 CPU 和 PIO 就能使用这 8个引脚交换数据了。

​		接下来要把 Z80 PIO 的 B/A 和 C/D 引脚分别连接到 Z80 CPU 的地址总线引脚 A0 和 A1 上。若表示 IC 引脚作用的代号上划有横线，则表示通过赋予该引脚 0（0V）可使之有效，反之若没有横线，则表示通过赋予该引脚 1（+5V）可使之有效。因此若赋予 B/A 引脚 1 则表示选中 B，反之赋予 0 则表示选中 A。同样地，若赋予 C/D 引脚 1 则表示选中的是 C（C 即 Control，表示控制模式）；反之赋予 0 则表示选中的是 D（D 即 Data，表示数据模式）。

​		Z80 CPU 的 A8～A15 地址总线引脚尚未使用，所以什么都不连接。在电路图中可以用代号 NC（No onnection，未连接）表示引脚什么都不连接。IC 上的引脚有些只用于输出，有些只用于输入，还有些是输入输出两用的。对于只用于输出的引脚，不需要使用时的处理方法是这个引脚什么都不连接；而对于只用于输入或输入输出两用的引脚，不需要使用时的处理方法则是把这个引脚上的电压固定成是 +5V 或 0V。



### 连接时钟信号

​		正如前文所述，Z80 CPU 和 Z80 PIO 的运转离不开时钟信号。为了传输时钟信号，就需要把时钟发生器的 8 号引脚和 Z80 CPU 的 CLK（CLK 即 Clock，时钟）引脚、Z80 PIO 的 CLK 引脚分别连接起来。时钟发生器的 8 号引脚与 +5V 之间的电阻用于清理时钟信号。  



### 连接用于区分读写对象是内存还是 I/O 的引脚

​		至此，我们已经先后把 Z80 CPU 连接到了 TC5517 和 Z80 PIO 上，这两次连接都使用了地址总线引脚 A0 和 A1。如果仅仅这样连接，就会导致一个问题，当地址的最后两位是 00、01、10 和 11 时，CPU 就无法区分访问的是 TC5517 中的存储单元，还是 Z80 PIO 中的寄存器了。

​		Z80 CPU 上的 MREQ（即 Memory Request，内存请求）引脚和 IORQ（即 I/O Request，I/O 请求）引脚解决了这个问题。当 Z80 CPU 和内存之间有数据输入输出时，MREQ 引脚上的值是 0，反之则是 1。当 Z80 CPU 和 I/O 之间有数据输入输出时，IORQ 引脚上的值是 0，反之则是 1。 		 

​		若把 TC5517 的 CE（即 Chip Enable，选通芯片）引脚设成 0，则TC5517 在 电 路 中 被 激 活， 若 设 成 1 则 从 电 路 中 隔 离， 因 为 此 时TC5517 进入了高阻抗状态，所以即便它上面的引脚已经接入了电路也不会接收任何电信号。在 Z80 PIO 中，则是通过将 CE 引脚和 IORQ 引脚同时设为 0 或 1，来达到与 TC5517 的 CE 引脚相同的效果。若同时设为 0，则 Z80 PIO 在电路中被激活，若同时设为 1 则从电路中隔离（之所以使用两个引脚是因为这样更适合使用了多个 I/O 的情况）。

​		按照上面的讲解，下面需要把 Z80 CPU 的 MREQ 引脚连接到 TC5517 的 CE 引脚上。然后把 Z80 CPU 的 IORQ 引脚连接到 Z80 PIO 的 CE 引脚和 IORQ 引脚上。请诸位先用红铅笔把这些引脚分别连接起来吧。

​		对内存和 I/O 而言，还必须要分清 CPU 是要输入数据还是输出数据。为此就要用到 Z80 CPU 的 RD 引脚（即 Read，表示输入，为 0 时执行输入操作）和 WR 引脚（即 Write，表示输出，为 0 时执行输出操作）了。请把这两个引脚与 TC5517 上同名的引脚连接起来。Z80 PIO虽然只有 RD 引脚，但由于数字 IC 引脚上的值要么是 0 要么是 1，所以只用 1 个 RD 引脚也能区分是输入还是输出，0 的话是输入，1 的话就是输出（如表 2.2 所示）。

![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/%E5%BC%95%E8%84%9A%E5%80%BC.png)



### 连接剩余的控制引脚

​		CPU、内存、I/O 中不但有地址总线引脚、数据总线引脚，还有其他引脚，通常把这些引脚统称为“控制引脚”。之所以这样命名是因为这些引脚上输入输出的电信号具有控制 IC 的功能。现在 Z80 CPU 上只剩下 9 个控制引脚没有连接了，那么就再加把劲，继续用红铅笔把它们也连接到电路中吧。

​		首先把 Z80 CPU 的 M1 引脚（即 Machine Cycle 1，机器周期 1）和INT 引脚（即 Interrupt，中断）与 Z80 PIO 上标有相同代号的引脚连接起来。M1 是用于同步的引脚，INT 引脚是用于从 Z80 PIO 向 Z80 CPU发出中断请求的引脚。所谓中断就是让 CPU 根据外部输入的数据执行特定的程序。 

​		一旦把 Z80 CPU 的 RESET 引脚（即 Reset，重置）上的值先设成 0再还原成 1，CPU 就会被重置，重新从内存 0 号地址上的指令开始顺序往下执行。重置 CPU 可以通过按键开关完成。按键开关需要经过电阻接在 +5V 和 0V 之间。请仔细地观察这一部分的电路图，可以看出RESET 引脚上平时是 +5V（即 1）。当按下按键开关时，RESET 引脚就变成了 0V（即 0），而放开按键开关后又会回到 +5V（即 1）。电阻是为了防止短路而加入的，否则一旦按下了按键开关，+5V 和 0V 就会直接接到一起发生短路。像这样通过加入电阻把 +5V 和 0V 连接起来的方 

法在电路图中随处可见（如图 2.8 所示）。

![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/%E5%BC%80%E5%85%B3%E8%BE%93%E5%85%A5.png)

​		连接在 RESET 引脚上的电容，用于在电路接通电源时自动重置CPU。电容就好像一个充电电池，具有储存电荷的功能。在通电后的一刹那，由于电容正在充电，所以 RESET 引脚上的电压并不会立刻上升到 +5V。而完成充电后，RESET 引脚的电压会变为 +5V，这样就相当于 RESET 引脚上的值从 0 变成了 1，重置了一次 CPU。 

​		总线是连接到 CPU 中数据引脚、地址引脚、控制引脚上的电路的统称。使用快动开关可以使 Z80 CPU 的 BUSRQ 引脚（即 Bus Request， 总线请求）上的值在 0 和 1 之间切换。若将 BUSRQ 引脚的值设为 0， 则 Z80 CPU 从电路中隔离。当处于这种隔离状态时，就可以不通过CPU，手动地向内存写入程序了。像这样不经过 CPU 而直接从外部设备读写内存的行为叫作 DMA（Direct Memory Access，直接存储器访问）。在诸位所使用的个人计算机里，硬盘等设备要读写内存时使用的就是 DMA。

​		当 Z80 CPU 从电路中隔离后，BUSAK 引脚（即 Bus Acknowledge， 响应总线请求）上的值就会变成 0。也就是说，把 BUSRQ 引脚上的值设成 0 以后，还要确认 BUSAK 引脚上的值已经变成了 0，然后才能进行 DMA。请把 BUSAK 引脚分别连接到 4 个 74367 的 G1 和 G2 引脚上。有关 74367 的作用将在后面说明。 

​		Z80 CPU 的其他控制引脚并未使用。所以要把 WAIT 引脚和 NMI引脚上的值设为 1，即连接到 +5V 上。之所以在连接时加入电阻，是为了便于今后加入开关等元件。请诸位先记住一个词——上拉（Pull-up），指的就是像这样通过加入电阻把元件的引脚和 +5V 连接起来。剩下的 HALT 引脚和 ASTB 引脚什么都不连接。  

​		Z80 PIO 的 PA0～PA7（PA 表示 Port A）以及 PB0～PB7（PB 表示Port B）用于与外部设备进行输入输出，所以稍后要把它们分别连接到指拨开关和 LED 上。对于剩下的几个引脚可以这样处理：将 IEI 引脚上拉，IEO 引脚、ASTB 引脚、ARDY 引脚、BSTB 引脚和 BRDY 引脚则什么都不连接。 

​		到此为止，Z80 CPU、TC5517、Z80 PIO 以及时钟发生器上要用到的引脚就都接入电路了。这意味着计算机主机系统的功能完成了。作为总结，表 2.3 汇总了这几块 IC 上引脚的作用以及电信号的输入输出方向（从各个 IC 的角度看）。

​		虽然需要连接的电路有点多，但也并不是太复杂吧？其实计算机的工作原理非常简单。CPU在时钟信号的控制下解释、执行内存中存储的程序，按照程序中的指令从内存或 I/O 中把数据输入到 CPU 中，在 CPU 内部进行运算，再把运算结果输出到内存或 I/O 中。无论是小型的微型计算机，还是高性能的个人计算机，其工作原理都是相同的。

![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/%E5%BC%95%E8%84%9A%E4%BD%9C%E7%94%A8%E5%92%8C%E8%BE%93%E5%85%A5%E6%96%B9%E5%90%91.png)

![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/%E5%BC%95%E8%84%9A%E4%BD%9C%E7%94%A8%E4%B8%8E%E8%BE%93%E5%85%A5%E6%96%B9%E5%90%912.png)

### 连接外部设备，通过 DMA 输入程序

​		下面我们继续布线，这次将计算机主机系统和外部设备连接起来。我们要使用 2 个指拨开关和 1 个按键开关，向地址总线引脚和数据总线引脚发送电信号，然后通过 DMA 将数据总线上的数据存储到内存。 下面我们就先将这些元件连接到电路中。

​		首先将图 2.1 中右侧最上方的一个指拨开关连接到作为内存的TC5517 的数据总线引脚 D0～D7 上。再将它下面紧挨着它的指拨开关连接到 TC5517 的地址总线引脚 A0～A7 上。第 3 个指拨开关则通过电阻接到 +5V 上，这样拨动这个指拨开关就可以输入 +5V 或 0V 的信号了。接下来将用于控制内存写入的按键开关连接到 TC5517 的 WE 引脚上。为了写入数据，还要将 TC5517 的 RD 引脚上拉起来，连接到 +5V上，然后把 CE 引脚连接到 0V 上。把这些元件都连接起来以后，就可以拨动指拨开关，用二进制数设定地址总线引脚和数据总线引脚上的数据了。设定完后按下按键开关，数据就会被写入 TC5517 中。

​		但是如果这些开关直接连接到了 TC5517 的各个引脚上，在程序执行时，开关的状态就会对电路产生影响。因此要使用 74367，在程序执行时把开关从电路中隔离出来。74367 是一种叫作“三态总线缓冲器”的 IC。在这个 IC 的电路图符号中，有用三角形标志代表的缓冲器，表示使电信号从右向左直接通过。但是，只有在 74367 的 G1 引脚和 G2引脚同时为 0 的时候，电信号才能通过。而当 G1 引脚和 G2 引脚同时为 1 时，74367 就会与电路隔离。

​		一旦打开了 Z80 CPU 的 BUSRQ 引脚连接着的开关，就可以通过BUSAK 引脚输出 0 得知 CPU 进入了 DMA 状态。因此只要把 BUSAK引脚连接到 4 个 74367 的 G1 引脚和 G2 引脚上，就可以实现通过连接用于输入输出的外部设备DMA 向内存写入数据了。

### 连接用于输入输出的外部设备

​		布线终于快结束了。下面该轮到把指拨开关和 LED 连接到 Z80PIO 上了。当微型计算机运行起来后，指拨开关可用于从外部输入数据，LED 可用于向外部输出数据。 

​		用于输入数据的指拨开关，要连接到 Z80 PIO 的 PA0～PA7 引脚上。连接时没有使用 74367 是为了在程序运行中可以通过 Z80 PIO 从指拨开关获得输入的数据。 

​		表示输出数据的 LED 要通过电阻连接到 +5V 上。这里的布线方法依据惯例，输入 0V 点亮 LED（如图 2.9 所示）。LED 要通过 7404 这样的 IC 连接到 Z80 PIO 的 PB0～PB7 引脚上。在 7404 的电路图符号中，末端带有一个小圆圈的三角形符号表示反相器，作用是将左侧输入的电信号反转后（即 0 变 1、1 变 0）输出到右侧。通过这样的设计，当Z80 PIO 的 PB0～PB7 引脚上的值为 0 时 LED 就会熄灭，为 1 时 LED就会点亮。

![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/%E7%82%B9%E4%BA%AELED.png)

​		是不是觉得忘记了什么呢？没错！ 74367 和 7404 上也都有 Vcc 引脚和 GND 引脚。请将它们分别连接到 +5V 和 0V 上。对于 74367 和7404 中未使用的引脚（标有 NC 的引脚），或者什么都不连接，或者将它们连接到 GND 上。



### 输入测试程序并进行调试

​		微型计算机终于顺利地制作出来了，到此硬件组装好了，但若没有输入软件，计算机还是不能工作的。所以即使为微型计算机接通了电源，它也什么都执行不了。 

​		下面就编写一段测试程序吧。编写时可以使用哪种编程语言呢？ 是 BASIC、C 语言，还是 Java 呢？其实这些语言都无法使用，因为作为计算机大脑的 CPU 只能解释执行一种编程语言，那就是靠罗列二进制数构成的机器语言（原生代码）。代码清单 2.1 展示了一段用机器语言编写的测试程序。程序是指令和数据的集合，表示指令或数据的数 值是以 8 比特为一个单位存储到内存中的。这段程序只实现了一个简单的功能，那就是通过拨动连接到 Z80 PIO 上的指拨开关控制 LED 的亮或灭。

![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/%E6%9C%BA%E5%99%A8%E8%AF%AD%E8%A8%80.png)

![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/%E6%9C%BA%E5%99%A8%E8%AF%AD%E8%A8%8002.png)

​		接通了微型计算机的电源后，请按下 Z80 CPU 上的 DMA 请求开关。在这个状态下，拨动用于输入内存程序和指定内存输入地址的两个指拨开关，把代码清单 2.1 所示的程序一行接一行地输入内存。先来输入第一行代码，拨动用于指定地址的指拨开关，设定出第一行代码所在的内存地址 00000000，然后拨动用于输入程序的指拨开关，设定 出程序代码 00111110。再然后按下用于向内存写入程序的按键开关。 接下来输入第二行代码，设定出内存地址 00000001，设定出程序代码11001111，再次按下按键开关。反复进行这三步操作，直至输入完程序代码的最后一行。所有的指令都输入完成后，按下用于重置 CPU 的按键开关，控制 DMA 请求的快动开关就会还原成关闭状态，与此同时程序也就运行起来了（如照片 2.2 所示）。

​		程序一旦运行起来，就可以用第 3 个指拨开关控制 LED 的亮与灭。只要拨动指拨开关，LED 的亮灭就会随之改变。LED 并不会只亮一下，而是一直亮着，时刻保持着指拨开关上的状态。

![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/Z80%E6%9D%BF.png)



## 关键元器件的详细说明

### cpu时钟与作用

​		处理器芯片是在特定的时钟频率下进行工作的。处理器的速度用时钟频率衡量。
首先你要明白什么是频率，频率的单位Hz（赫兹）。1Hz就是每秒完成一个周期，10Hz是每秒完成10个周期。不过，Hz这个单位太小了，通常以KHz、MHz或GHz来表示信号频率。
1GHz=1000MHz 1MHz=1000KHz 1KHz=1000Hz
周期是处理器处理指令的最小时间单元，每个计算机指令都需要若干个周期才能完成。
处理器的时钟频率越快，完成一个指令的时间就越短，速度就越快，或者说，在相同的周期内，时钟频率快的处理器可以完成更多的指令。时钟频率为1GHz的处理器，就意味着每秒可以完成1000000000个周期，执行指令来，就要比1MHz的处理器快了 

​	为什么要用cpu时钟那？

​	首先考虑如下逻辑电路：

![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/%E8%A7%A3%E9%87%8A%E6%97%B6%E9%92%9F%E7%9A%84%E4%BD%9C%E7%94%A8.png)

当A=B=1时，Q=0。当输入信号发生变化时，逻辑元件不会立即对输入变化做出反应，会有一个传播时延（propagation delay）。当B变化为0时，由于B也作为XOR的直接输入，所以XOR异或门会立即感知一个输入变为0的状态变化，XOR输出变为了1。但是由于传播时延的作用，AND与门的输出会过一小段时间才变为0，XOR的输出会在变为1后隔一小段时间重现变为0，表现为下图就是这样：

![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/%E6%B2%A1%E6%9C%89%E6%97%B6%E9%92%9F%E4%B8%8B%E7%9A%84%E7%A9%BA%E7%BF%BB.png)

就会出现一个微小时段的错误数据。



### cpu工作原理

CPU = ALU ➕ CU 

ALU 算术逻辑单元（Arithmetic&logical Unit）：是中央处理器(CPU)的执行单元，是所有中央处理器的核心组成部分，由"And Gate"（与门） 和"Or Gate"（或门）构成的算术逻辑单元，主要功能是进行二位元的算术运算，如加减乘(不包括整数除法)。基本上，在所有现代CPU体系结构中，二进制都以补码的形式来表示。

CU 控制单元（Control Unit）：负责程序的流程管理。控制单元是整个 CPU 的指挥控制中心，由指令寄存器IR(Instruction Register)、指令译码器ID(Instruction Decoder)和操作控制器OC(Operation Controller)三个部件组成，对协调整个电脑有序工作极为重要。 



![](https://yit-integration.oss-cn-hangzhou.aliyuncs.com/CRM/TECH/cpu%E6%89%A7%E8%A1%8C%E6%8C%87%E4%BB%A4.png)